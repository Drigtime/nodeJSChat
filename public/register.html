<html>

<head>
	<title>Projet : Authentification </title>
	<meta charset="UTF-8" />
	<link rel="stylesheet" href="css/Auth.css" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<style type="text/css">
		body {
			background-color: #F2F2F2;
		}
	</style>
	<script>
		// if (localStorage.token) window.location.replace("/");
	</script>
</head>

<body>
	<div class="wrapper">
		<div id="formContent">
      <form action="/Auth">
        <button class="btn btn-outline-primary" style="margin-left: -350px;margin-top: 10px;" type="submit"> Retour </button>
      </form>
<!--       <a class='hyperlien underlinehover' href='/Auth'>Retour</a> -->
			<h2><label class="labelTitle underlineHover labelauth"> inscription </label></h2>

		<form id="Register">
      <input type="text" id="pseudo" name="pseudo" placeholder="Pseudo" required />
			<input type="text" id="email" name="email" placeholder="adresse e-mail" required />
			<input type="password" id="password" name="password" placeholder="Mot de passe" required />
      <input type="password" id="password2" name="password2" placeholder="Confirmation du mot de passe" required />
			<button type="submit" class="btn btn-primary"> Inscription </button>
		</form>
  </div>
	</div>
</body>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
	integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
	integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
	crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
	integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
	crossorigin="anonymous"></script>
<script type="text/javascript">
  
	$("#Register").submit(function (e) {
      e.preventDefault(); // avoid to execute the actual submit of the form.
    var $password1 = $('#password').val();
    var $password2 = $('#password2').val();

    if ($password1 === $password2) {
      $.ajax({
        method: "POST",
        url: "/api/users",
        contentType: "application/json",
        data: JSON.stringify({
          name: $('#pseudo').val(),
          email: $('#email').val(),
          password: $('#password').val(),
        }),
        success: function (data) {
          localStorage.setItem('token', data.token)
          document.cookie = "token=" + data.token;

          window.location.replace("/chat");
        }
      });
    } else {
      console.log($password1);
      console.log($password2);
      alert('Les mots de passe ne sont pas identique.');
    }
	});
</script>

</html>